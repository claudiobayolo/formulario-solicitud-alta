<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solicitud de Cotización - Telefónica</title>
  
  <style>
    /* --- ESTILOS CORPORATIVOS TELEFÓNICA (Basados en Index_2.html) --- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(135deg, #f3f6fb 0%, #dde7f7 40%, #f5f9ff 100%);
      min-height: 100vh; padding: 20px; color: #333;
    }
    .container {
      max-width: 900px; margin: 0 auto; background: #fff;
      border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); overflow: hidden;
    }
    .header {
      background: #00377b; /* Azul Telefónica */
      color: white; padding: 25px 30px; text-align: center;
    }
    .header h1 { margin: 0; font-size: 1.8rem; font-weight: 600; }
    
    .content-wrapper { padding: 30px; }
    
    .section-title {
      font-size: 1.1rem; font-weight: 700; color: #00377b;
      margin-bottom: 20px; padding-bottom: 8px; border-bottom: 2px solid #e1e8f0;
      margin-top: 30px;
    }
    .section-title:first-child { margin-top: 0; }

    .row { display: flex; flex-wrap: wrap; margin: 0 -10px; margin-bottom: 15px; }
    .col { flex: 1; padding: 0 10px; min-width: 250px; }
    .col-full { flex: 100%; padding: 0 10px; margin-bottom: 15px;}

    label { display: block; margin-bottom: 6px; font-weight: 500; font-size: 0.9rem; color: #555; }
    
    input, select, textarea {
      width: 100%; padding: 10px 12px; border: 1px solid #ccd6e0; border-radius: 4px;
      font-size: 0.95rem; transition: border-color 0.2s, box-shadow 0.2s;
    }
    input:focus, select:focus, textarea:focus {
      border-color: #00A9E0; outline: none; box-shadow: 0 0 0 3px rgba(0,169,224,0.1);
    }
    input[readonly] { background-color: #f2f4f6; color: #777; cursor: default; }

    /* Botones */
    .btn-action {
      display: block; width: 100%; padding: 14px; background: #00A9E0; /* Cyan Telefónica */
      color: white; border: none; border-radius: 4px; font-weight: 600; font-size: 1rem;
      cursor: pointer; transition: background 0.2s; margin-top: 20px;
    }
    .btn-action:hover { background: #0090c0; }
    
    .btn-add {
      background: #5CB85C; color: white; border: none; padding: 8px 15px;
      border-radius: 4px; font-size: 0.85rem; cursor: pointer; display: inline-block;
      margin-top: 10px;
    }
    .btn-remove {
      background: #d9534f; color: white; border: none; padding: 5px 10px;
      border-radius: 4px; font-size: 0.8rem; cursor: pointer; float: right;
    }

    /* Tarjeta de Dirección para Multidirección */
    .address-card {
      background: #fafbfc; border: 1px border #e1e8f0; border-left: 4px solid #00A9E0;
      padding: 15px; margin-bottom: 15px; border-radius: 4px;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>Solicitud de Cotización</h1>
  </div>

  <form id="cotizacionForm" class="content-wrapper">
    
    <!-- 1. IDENTIFICADOR DEL CLIENTE -->
    <div class="section-title">1. Identificador del Cliente y Proyecto</div>
    
    <div class="row">
      <div class="col">
        <label>Fecha Solicitud</label>
        <input type="date" id="fechaSolicitud" readonly>
      </div>
      <div class="col">
        <label>RUT Cliente (Valida en SER.cl)</label>
        <input type="text" id="rut" placeholder="Ej: 76.123.456-K" onblur="buscarCliente()">
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>Razón Social</label>
        <input type="text" id="razonSocial" readonly placeholder="Se completa automático...">
      </div>
      <div class="col">
        <label>N° Proyecto</label>
        <input type="text" id="numeroProyecto" placeholder="Texto libre">
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>Ejecutivo Comercial</label>
        <input type="text" id="ejecutivoComercial" placeholder="Nombre Apellido">
      </div>
      <div class="col">
        <label>Preventa</label>
        <select id="preventa">
          <option value="">Seleccione...</option>
          <option>ANDRES ALBERTO TAPIA LAGOS</option><option>CARLOS AROS HERRERA</option><option>CLAUDIO GUERRA VELIZ</option><option>CLAUDIO VARAS CARRILLO</option><option>DANIEL DAVID CARTEZ CÓRDOVA</option><option>DAVID ROMERO</option><option>ELIAZIN GALLARDO ASENCIO</option><option>ENZO BENAVIDES</option><option>ERWIN ISIDRO CID GALAF</option><option>EVELYN CONTRERAS CONTRERAS</option><option>FELIPE NAVARRO</option><option>FRANCISCO JAVIER ESCOBAR</option><option>FRANCO MARTÍNEZ DONOSO</option><option>GERARDO ANTONIO MONTECINOS MELLADO</option><option>GUSTAVO ADOLFO GERDING VARGAS</option><option>HECTOR FERNANDO RUIZ MENDOZA</option><option>HÉCTOR VALLADARES NUÑEZ</option><option>HELTON JUAN SEPULVEDA ARAVENA</option><option>HENRY NICOLAS FARIÑE VELIZ</option><option>IGNACIO DIAZ</option><option>ITALO UNDURRAGA ROJAS</option><option>IVÁN SARMIENTO</option><option>JAIME BARRERA PRIETO</option><option>JORGE OSVALDO FIGUEROA SOTO</option><option>JORGE RIVANO CONCHA</option><option>JOSÉ LABRÍN ESCOBEDO</option><option>JOSE LUIS CASTILLO VASQUEZ</option><option>JOSE MIGUEL ARANCIBIA</option><option>JUAN CARLOS JIMENEZ</option><option>JUANA CRISTINA NARVAEZ ARACENA</option><option>KATHIUSKA DE LA SANTISIMA TRI PERAZA MARTINEZ</option><option>LORENA ESPINOZA MEDINA</option><option>LUIS ORTIZ</option><option>MANUEL MACHUCA CARRASCO</option><option>MANUEL TORO CASAS-CORDERO</option><option>MAURICIO GUERRERO</option><option>NICOLAS CERDA</option><option>PABLO ORTEGA</option><option>RAÚL MARTÍNEZ ARAVENA</option><option>REINALDO PERDOMO MARCANO</option><option>RICHARD LIZARDO MALERMO NUÑEZ</option><option>ROBERTO CARLOS AROS ANGULO</option><option>ROBERTO FERNANDO PEREZ MOREIRA</option><option>ROBERTO TRINCADO</option><option>RONALD CAÑIZALES</option><option>RUBEN DAVID NAVIO GOMEZ</option><option>RUTH CAROLINA SOTO AVILES</option><option>WILLIAM CÁRDENAS FUENTES</option><option>YERKO ALEXANDER FLORES OSSES</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>Plazo Contratación (Meses)</label>
        <select id="plazo">
          <option value="12">12</option>
          <option value="24">24</option>
          <option value="36">36</option>
          <option value="48">48</option>
          <option value="60">60</option>
        </select>
      </div>
    </div>

    <!-- 2. DIRECCIONES (MULTIDIRECCIÓN) -->
    <div class="section-title">2. Direcciones Extremo Usuario (Sitios)</div>
    
    <div id="listaDirecciones">
      <!-- Aquí se insertan dinámicamente las direcciones -->
    </div>

    <button type="button" class="btn-add" onclick="agregarBloqueDireccion()">+ Agregar Dirección</button>

    <!-- 3. PARÁMETROS DEL SERVICIO -->
    <div class="section-title">3. Parámetros e Información Mínima</div>

    <div class="row">
      <div class="col">
        <label>Dirección Extremo Nodo</label>
        <input type="text" id="direccionNodo" placeholder="Buscar dirección...">
      </div>
      <div class="col">
        <label>Producto</label>
        <select id="producto">
          <option value="ID">ID</option>
          <option value="Capa2">Capa2</option>
          <option value="Capa3">Capa3</option>
          <option value="EoDWDM">EoDWDM</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>Velocidad (BW)</label>
        <select id="velocidad">
          <option value="">Seleccione...</option>
          <option>1 MB</option><option>2 MB</option><option>3 MB</option><option>4 MB</option><option>5 MB</option><option>10 MB</option><option>15 MB</option><option>20 MB</option><option>25 MB</option><option>30 MB</option><option>35 MB</option><option>40 MB</option><option>45 MB</option><option>50 MB</option><option>100 MB</option><option>150 MB</option><option>200 MB</option><option>250 MB</option><option>300 MB</option><option>350 MB</option><option>400 MB</option><option>450 MB</option><option>500 MB</option><option>550 MB</option><option>600 MB</option><option>650 MB</option><option>700 MB</option><option>750 MB</option><option>800 MB</option><option>850 MB</option><option>900 MB</option><option>1 GB</option><option>2 GB</option><option>3 GB</option><option>4 GB</option><option>5 GB</option><option>6 GB</option><option>7 GB</option><option>8 GB</option><option>9 GB</option><option>10 GB</option><option>100 GB</option>
        </select>
      </div>
      <div class="col">
        <label>Habilitación</label>
        <select id="habilitacion">
          <option>Diurna</option>
          <option>Nocturna</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>Protección</label>
        <select id="proteccion">
          <option>1+0</option>
          <option>1+1</option>
          <option>0+1</option>
        </select>
      </div>
      <div class="col">
        <label>Contacto Técnico</label>
        <input type="text" id="contactoTecnico" placeholder="Nombre Apellido">
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>Fono Contacto Técnico</label>
        <input type="text" id="fonoTecnico" value="+56">
      </div>
      <div class="col">
        <label>Subcategoría</label>
        <input type="text" id="subcategoria" placeholder="No Aplica">
      </div>
    </div>

    <div class="row">
      <div class="col-full">
        <label>Observaciones</label>
        <textarea id="observaciones" rows="3"></textarea>
      </div>
    </div>

    <button type="button" class="btn-action" onclick="enviar()">Guardar Cotización</button>

  </form>
</div>

<script>
  // --- LÓGICA DE INICIALIZACIÓN ---
  window.onload = function() {
    // 1. Establecer fecha de hoy
    document.getElementById('fechaSolicitud').valueAsDate = new Date();
    // 2. Agregar la primera dirección por defecto
    agregarBloqueDireccion();
  };

  // --- LÓGICA DE MULTIDIRECCIÓN ---
  function agregarBloqueDireccion() {
    const container = document.getElementById('listaDirecciones');
    const id = Date.now(); // ID único para cada bloque
    
    const html = `
      <div class="address-card" id="dir-${id}">
        ${container.children.length > 0 ? `<button type="button" class="btn-remove" onclick="eliminarDireccion('dir-${id}')">Eliminar</button>` : ''}
        <div class="row">
          <div class="col-full">
            <label>Dirección Extremo Usuario (Búsqueda Google)</label>
            <input type="text" class="input-direccion" placeholder="Escriba dirección exacta...">
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label>Comuna</label>
            <input type="text" class="input-comuna" readonly>
          </div>
          <div class="col">
            <label>Latitud</label>
            <input type="text" class="input-lat" readonly>
          </div>
          <div class="col">
            <label>Longitud</label>
            <input type="text" class="input-long" readonly>
          </div>
        </div>
      </div>
    `;
    container.insertAdjacentHTML('beforeend', html);
    
    // Aquí deberíamos reinicializar el Autocomplete de Google Maps para el nuevo input
    // initAutocompletePara(document.querySelector(`#dir-${id} .input-direccion`));
  }

  function eliminarDireccion(id) {
    document.getElementById(id).remove();
  }

  // --- LÓGICA DE SIMULACIÓN (HASTA CONECTAR CON GOOGLE SHEETS) ---
  function buscarCliente() {
    const rut = document.getElementById('rut').value;
    if(rut.length > 3) {
      document.getElementById('razonSocial').value = "CLIENTE DEMO S.A."; // Simulación
    }
  }

  function enviar() {
    // Recopilar Datos
    const direcciones = [];
    document.querySelectorAll('.address-card').forEach(card => {
      direcciones.push({
        direccion: card.querySelector('.input-direccion').value,
        comuna: card.querySelector('.input-comuna').value,
        lat: card.querySelector('.input-lat').value,
        long: card.querySelector('.input-long').value
      });
    });

    const payload = {
      fecha: document.getElementById('fechaSolicitud').value,
      rut: document.getElementById('rut').value,
      razon: document.getElementById('razonSocial').value,
      preventa: document.getElementById('preventa').value,
      sitios: direcciones,
      // ... resto de campos
    };
    
    alert("Datos capturados (Ver consola). Ahora falta conectar a Google Sheets.");
    console.log(payload);
  }
</script>

<!-- API DE GOOGLE MAPS (Debes poner tu API KEY real abajo donde dice YOUR_API_KEY) -->
<!-- <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initMap" async defer></script> -->

</body>
</html>
